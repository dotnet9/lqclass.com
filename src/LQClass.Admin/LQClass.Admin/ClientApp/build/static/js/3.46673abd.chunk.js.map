{"version":3,"sources":["store/dataSource/index.tsx","components/form/cascader/index.tsx","components/form/checkbox/index.tsx","components/form/datePicker/index.tsx","components/form/editer/index.tsx","components/form/editTable/index.tsx","components/form/radio/index.tsx","components/form/select/index.tsx","components/form/transfer/index.tsx","components/form/upload/index.tsx","components/form/uploadImg/index.tsx","components/form/index.ts"],"names":["PageStore","BindAll","options","Apis","IdKey","Target","globalConfig","target","DataSource","PageState","Observable","this","PageObservable","params","tableLoading","onSearch","res","tableList","onDetails","details","onInsert","success","message","getLocalesValue","onUpdate","onDelete","selectedRowKeys","searchParams","error","UploadFileId","onImport","onErrorMessage","value","key","FileId","RequestFiles","download","export","url","Request","compatibleUrl","body","ids","exportIds","template","dataSource","duration","description","length","itemLayout","renderItem","item","Item","style","width","span","type","onClick","e","onFileDownload","method","SortInfo","Page","Limit","runInAction","ajax","search","pipe","map","data","Data","obj","Help","GUID","Count","PageCount","toPromise","insert","update","delete","import","_tableLoading","_visiblePort","observable","computed","_tableList","_details","_searchParams","toJS","_selectedRowData","_selectedRowKeys","DesError","title","ParentIdKey","children","childrenUrl","state","loading","mockData","originalData","Unmount","handleChange","targetKeys","props","dataKey","x","onChange","loadData","selectedOptions","a","targetOption","time","Date","now","cache","Promise","rej","mapData","bind","setState","nextProps","nextState","nextContext","recursionTree","datalist","ParentId","label","push","Value","newItem","getParent","defaultValue","config","str","join","placeholder","allowClear","changeOnSelect","disabled","getDefaultValue","spinning","display","renderDisplay","React","Component","wtmType","WtmCheckbox","DesLoadingData","Group","align","RangePicker","MonthPicker","WtmDatePicker","WeekPicker","dataString","showTime","format","getFormat","moment","WtmRangePicker","WtmEditor","console","development","default","media","uploadFn","customRequest","action","FileTarget","filename","file","onProgress","event","progress","percent","onSuccess","Id","meta","id","Name","alt","loop","autoPlay","controls","poster","onError","err","msg","editorState","BraftEditor","createEditorState","toRAW","toHTML","className","EditableContext","createContext","EditableRow","DesForm","FieldsValue","rowKey","handleUpdate","form","validateFields","values","models","getFieldsValue","restProps","Provider","onMouseEnter","onEdit","onMouseLeave","EditableCell","fieId","dataIndex","layout","defaultValues","record","index","Consumer","renderForm","EditTable","Debounce","observer","onUpdateDataSource","columns","createColumns","deleteButton","render","text","handleRemove","setValues","__key","columnsProps","onCell","rowIndex","formItemProps","renderEmpty","addButton","handleAdd","bordered","components","row","cell","pagination","scroll","reduce","accumulator","currentValue","Math","ceil","WtmEditTable","WtmRadio","WtmSelect","getLocalesTemplate","txt","showSearch","filterOption","input","option","toLowerCase","indexOf","Option","WtmTransfer","WtmUpload","img","Image","previewVisible","previewImage","fileList","uid","name","status","onFileUrl","info","response","createViewer","onRemove","fileId","setTimeout","onFileDelete","src","beforeUpload","isJPG","WtmUploadImg","viewer","Viewer","handlePreview","show","undefined","destroy","uploadButton","minWidth","minHeight","accept","listType","onPreview"],"mappings":"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","file":"static/js/3.46673abd.chunk.js","sourcesContent":["/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2018-09-12 18:52:27\r\n * @modify date 2018-09-12 18:52:27\r\n * @desc [description] .\r\n */\r\nimport { message, notification, List, Col, Row, Button } from 'antd';\r\nimport globalConfig from 'global.config';\r\nimport lodash from 'lodash';\r\nimport { getLocalesValue } from 'locale';\r\nimport { BindAll } from 'lodash-decorators';\r\nimport { computed, observable, toJS, runInAction } from 'mobx';\r\nimport { map } from 'rxjs/operators';\r\nimport { Help } from 'utils/Help';\r\nimport { Request } from 'utils/Request';\r\nimport RequestFiles from 'utils/RequestFiles';\r\nimport React from 'react';\r\ndeclare type PageStoreOptions = {\r\n  /** api 列表 */\r\n  Apis: WTM.IUrls,\r\n  IdKey?: string,\r\n  Target?: string,\r\n};\r\n/**\r\n * 搜索 参数\r\n */\r\nexport declare type ISearchParams = {\r\n  /** 搜索条件 */\r\n  // search?: Object,\r\n  /** 排序 字符 */\r\n  SortInfo?: any,\r\n  /** 页码 */\r\n  Page?: number,\r\n  /** 条数 */\r\n  Limit?: number\r\n};\r\n@BindAll()\r\nexport default class PageStore {\r\n  public options: PageStoreOptions = {\r\n    Apis: {},\r\n    IdKey: \"ID\",\r\n    Target: globalConfig.target,\r\n  };\r\n  constructor(options: PageStoreOptions) {\r\n    this.options = { ...this.options, ...options };\r\n    this.Observable = new PageObservable(this, this.options);\r\n    this.DataSource = new DataSource(this, this.options);\r\n    this.PageState = new PageState(this, this.options);\r\n  }\r\n  /** 数据 */\r\n  DataSource: DataSource;\r\n  /** 状态 */\r\n  PageState: PageState;\r\n  /** 数据管道  */\r\n  Observable: PageObservable;// = new PageObservable(this, this.options);\r\n  /** 搜索 */\r\n  async onSearch(params?: ISearchParams) {\r\n    try {\r\n      // if (this.PageState.tableLoading) {\r\n      //   return\r\n      // }\r\n      this.PageState.tableLoading = true;\r\n      const res = await this.Observable.onSearch(params);\r\n      this.DataSource.tableList = res;\r\n      this.PageState.tableLoading = false;\r\n      return res;\r\n    } catch (error) {\r\n      // console.warn(error)\r\n      this.PageState.tableLoading = false;\r\n      throw error\r\n    }\r\n  }\r\n  /** 详情 */\r\n  async onDetails(params) {\r\n    const res = await this.Observable.onDetails(params);\r\n    this.DataSource.details = res;\r\n    return res;\r\n  }\r\n  /** 添加 */\r\n  async onInsert(params) {\r\n    const res = await this.Observable.onInsert(params);\r\n    notification.success({ message: getLocalesValue('tips.success.operation') });\r\n    this.onSearch();\r\n    return res;\r\n  }\r\n  /** 修改 */\r\n  async onUpdate(params) {\r\n    const res = await this.Observable.onUpdate(this.DataSource.details, params);\r\n    notification.success({ message: getLocalesValue('tips.success.operation') });\r\n    this.onSearch();\r\n    return res;\r\n  }\r\n  /**\r\n   * 删除\r\n   * @param params \r\n   */\r\n  async onDelete(params: string[]) {\r\n    this.PageState.tableLoading = true;\r\n    try {\r\n      if (!lodash.isArray(params)) {\r\n        if (lodash.isObject(params)) {\r\n          params = lodash.get(params, this.options.IdKey);\r\n        }\r\n        params = [params as any];\r\n      }\r\n      const res = await this.Observable.onDelete(params)\r\n      notification.success({ message: getLocalesValue('tips.success.operation') });\r\n      this.DataSource.selectedRowKeys = [];\r\n      // 刷新数据\r\n      this.onSearch(this.DataSource.searchParams);\r\n      return res\r\n    } catch (error) {\r\n      this.PageState.tableLoading = false;\r\n      notification.error({ message: getLocalesValue('tips.error.operation') });\r\n    }\r\n  }\r\n  /**\r\n   * 导入\r\n   * @param UploadFileId \r\n   */\r\n  async onImport(UploadFileId) {\r\n    try {\r\n      const res = await this.Observable.onImport(UploadFileId);\r\n      notification.success({ message: getLocalesValue('tips.success.operation') });\r\n      return res\r\n    } catch (error) {\r\n      this.onErrorMessage(getLocalesValue('tips.error.import'), [{ value: lodash.get(error, 'Form[\"Entity.Import\"]'), key: null, FileId: lodash.get(error, 'Form[\"Entity.ErrorFileId\"]') }])\r\n    }\r\n  }\r\n  /**\r\n   * 导出\r\n   * @param params 筛选参数\r\n   */\r\n  async onExport(params?) {\r\n    await RequestFiles.download({\r\n      ...this.options.Apis.export,\r\n      url: Request.compatibleUrl(this.options.Target, this.options.Apis.export.url),\r\n      body: { ...this.DataSource.searchParams, ...params }\r\n    })\r\n  }\r\n  /**\r\n   * 导出\r\n   * @param params 筛选参数\r\n   */\r\n  async onExportIds(ids = this.DataSource.selectedRowKeys) {\r\n    await RequestFiles.download({\r\n      ...this.options.Apis.exportIds,\r\n      url: Request.compatibleUrl(this.options.Target, this.options.Apis.exportIds.url),\r\n      body: ids\r\n    })\r\n  }\r\n  /**\r\n  * 数据模板\r\n  */\r\n  async onTemplate() {\r\n    await RequestFiles.download({\r\n      ...this.options.Apis.template,\r\n      url: Request.compatibleUrl(this.options.Target, this.options.Apis.template.url)\r\n    })\r\n  }\r\n  /**\r\n   * 错误提示\r\n   * @param message \r\n   * @param dataSource \r\n   */\r\n  onErrorMessage(message, dataSource?: { key: string, value: string, FileId?: string }[]) {\r\n    notification.error({\r\n      duration: 5,\r\n      message: message,\r\n      description: dataSource && dataSource.length > 0 && <List\r\n        itemLayout=\"horizontal\"\r\n        dataSource={dataSource}\r\n        renderItem={item => (\r\n          <List.Item>\r\n            <Row style={{ width: \"100%\" }}>\r\n              {/* <Col span={10}>{item.key}</Col> */}\r\n              <Col span={14}>{item.value}</Col>\r\n              {item.FileId && <Col span={10}>\r\n                <Button type=\"primary\" onClick={e => {\r\n                  RequestFiles.download({ url: RequestFiles.onFileDownload(item.FileId, \"/\"), method: \"get\" })\r\n                }}>{getLocalesValue('tips.error.file')}</Button>\r\n              </Col>}\r\n            </Row>\r\n          </List.Item>\r\n        )}\r\n      />\r\n    })\r\n  }\r\n}\r\n/**\r\n * 页面数据管道\r\n */\r\nclass PageObservable {\r\n  constructor(private PageStore: PageStore, private options: PageStoreOptions) {\r\n  }\r\n  /**\r\n   * Ajax \r\n   */\r\n  Request = new Request(this.PageStore.options.Target);\r\n  /**\r\n   * 搜索\r\n   * @param params \r\n   */\r\n  onSearch(params): Promise<{ Count: number, Data: any[], Page: number, PageCount: number, Limit: number }> {\r\n    params = {\r\n      SortInfo: null,\r\n      Page: 1,\r\n      Limit: this.PageStore.DataSource.tableList.Limit,\r\n      ...this.PageStore.DataSource.searchParams,\r\n      ...params,\r\n    }\r\n    runInAction(() => {\r\n      this.PageStore.DataSource.searchParams = params;\r\n      this.PageStore.DataSource.tableList.Limit = params.Limit;\r\n    })\r\n    return this.Request.ajax({ ...this.options.Apis.search, body: params }).pipe(\r\n      map(data => {\r\n        if (data.Data) {\r\n          // 设置 一个 key 默认 去 idkey 中的值，没有则创建 一个 guid\r\n          data.Data = lodash.map(data.Data, obj => {\r\n            lodash.set(obj, 'key', lodash.get(obj, this.options.IdKey, Help.GUID()))\r\n            return obj\r\n          })\r\n        }\r\n        return {\r\n          Count: 0,\r\n          Data: [],\r\n          Page: 1,\r\n          PageCount: 1,\r\n          ...data,\r\n          Limit: params.Limit\r\n        }\r\n      })\r\n    ).toPromise();\r\n  };\r\n  /**\r\n   * 详情\r\n   * @param params \r\n   */\r\n  onDetails(params) {\r\n    //  字符串 为 ID 转换成 对象 匹配 /***/{ID} \r\n    if (lodash.isString(params)) {\r\n      params = lodash.set({}, this.options.IdKey, params);\r\n    }\r\n    return this.Request.ajax({ ...this.options.Apis.details, body: params }).toPromise();\r\n  };\r\n  /**\r\n   * 添加数据\r\n   * @param params 数据实体\r\n   */\r\n  onInsert(params) {\r\n    return this.Request.ajax({ ...this.options.Apis.insert, body: params }).toPromise();\r\n  };\r\n  /**\r\n   * 修改\r\n   * @param details \r\n   * @param params \r\n   */\r\n  onUpdate(details, params) {\r\n    // let isUpdate = false;\r\n    // lodash.map(params, (value, key) => {\r\n    //   if (!isUpdate) {\r\n    //     if (!lodash.isEqual(value, lodash.get(details, key))) {\r\n    //       isUpdate = true\r\n    //     }\r\n    //   }\r\n    // })\r\n    // if (isUpdate) {\r\n    return this.Request.ajax({ ...this.options.Apis.update, body: params }).toPromise();\r\n    // }\r\n    // return true\r\n  }\r\n  /**\r\n   * 删除\r\n   * @param ids \r\n   */\r\n  onDelete(ids) {\r\n    return this.Request.ajax({ ...this.options.Apis.delete, body: ids }).toPromise()\r\n  }\r\n  /**\r\n   * 导入\r\n   * @param UploadFileId \r\n   */\r\n  onImport(UploadFileId) {\r\n    return this.Request.ajax({ ...this.options.Apis.import, body: { UploadFileId } }).toPromise();\r\n  }\r\n}\r\n/**\r\n * 页面状态\r\n */\r\nclass PageState {\r\n  constructor(private PageStore: PageStore, private options: PageStoreOptions) {\r\n  }\r\n  @observable\r\n  private _tableLoading;\r\n  /**\r\n   * table 加载状态\r\n   */\r\n  @computed\r\n  public get tableLoading() {\r\n    return this._tableLoading;\r\n  }\r\n  public set tableLoading(value) {\r\n    this._tableLoading = value;\r\n  }\r\n  @observable\r\n  private _visiblePort;\r\n  /**\r\n   * 导入 visible\r\n   */\r\n  @computed\r\n  public get visiblePort() {\r\n    return this._visiblePort;\r\n  }\r\n  public set visiblePort(value) {\r\n    this._visiblePort = value;\r\n  }\r\n}\r\nclass DataSource {\r\n  constructor(private PageStore: PageStore, private options: PageStoreOptions) {\r\n  }\r\n  // 表格数据\r\n  @observable\r\n  private _tableList;\r\n  // 详情数据\r\n  @observable\r\n  private _details;\r\n  // 搜索参数\r\n  @observable\r\n  private _searchParams;\r\n  // 选择的行 数据\r\n  @observable\r\n  private _selectedRowData: any[];\r\n  @observable\r\n  private _selectedRowKeys: string[];\r\n  /**\r\n  * 表格数据\r\n  */\r\n  @computed\r\n  public get tableList(): {\r\n    Count: number,\r\n    Data: any[],\r\n    Limit: number,\r\n    Page: number,\r\n    PageCount: number\r\n  } {\r\n    return this._tableList || {\r\n      Count: 0,\r\n      Data: [],\r\n      Page: 1,\r\n      Limit: globalConfig.Limit,\r\n      PageCount: 1\r\n    };\r\n  }\r\n  public set tableList(value) {\r\n    this._tableList = value;\r\n  }\r\n  /**\r\n  * 详情\r\n  */\r\n  @computed\r\n  public get details() {\r\n    return this._details;\r\n  }\r\n  public set details(value) {\r\n    this._details = value;\r\n  }\r\n  /**\r\n   * 搜索参数\r\n   */\r\n  @computed\r\n  public get searchParams() {\r\n    return this._searchParams;\r\n  };\r\n  public set searchParams(value) {\r\n    this._searchParams = value;\r\n  };\r\n  /**\r\n   * 选择的 行 数据\r\n   */\r\n  @computed\r\n  public get selectedRowData() {\r\n    return toJS(this._selectedRowData) || [];\r\n  }\r\n  /**\r\n  * 选择的 行 数据 keys\r\n  */\r\n  @computed\r\n  public get selectedRowKeys() {\r\n    return toJS(this._selectedRowKeys) || [];\r\n  }\r\n  public set selectedRowKeys(value) {\r\n    this._selectedRowKeys = value;\r\n    this._selectedRowData = lodash.filter(this._tableList, item => lodash.includes(value, lodash.get(item, this.options.IdKey)));\r\n  }\r\n}\r\n","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:42\r\n * @modify date 2019-02-24 17:06:42\r\n * @desc [description]\r\n */\r\nimport { Cascader, Spin } from 'antd';\r\nimport { DesError } from 'components/decorators'; //错误\r\nimport lodash from 'lodash';\r\nimport React from 'react';\r\nimport { Observable } from 'rxjs';\r\nimport { CascaderProps } from 'antd/lib/cascader';\r\nimport Request from 'utils/Request';\r\n\r\ninterface IAppProps {\r\n    dataSource: Observable<any[]> | any[] | Promise<any[]>;\r\n    value?: any;\r\n    disabled?: boolean;\r\n    placeholder?: string;\r\n    CascaderProps?: CascaderProps;\r\n    display?: boolean;\r\n    /** 最后一级数据 */\r\n    lastData?: boolean;\r\n    [key: string]: any;\r\n}\r\n@DesError\r\nexport class WtmCascader extends React.Component<IAppProps, any> {\r\n    static wtmType = \"Cascader\";\r\n    key = \"Value\";\r\n    title = \"Text\";\r\n    ParentIdKey = \"ParentId\";\r\n    children = \"Children\";\r\n    childrenUrl = \"ChildrenUrl\";\r\n    // description = \"Text\";\r\n    state = {\r\n        loading: true,\r\n        mockData: [],\r\n        originalData: [] // 原始数据\r\n    }\r\n    /**\r\n      * 优化渲染\r\n      * @param nextProps \r\n      * @param nextState \r\n      * @param nextContext \r\n      */\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        if (!lodash.eq(this.state.loading, nextState.loading)) {\r\n            return true\r\n        }\r\n        if (!lodash.eq(this.state.originalData, nextState.originalData)) {\r\n            return true\r\n        }\r\n        if (!lodash.eq(this.props.value, nextProps.value)) {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    Unmount = false\r\n    componentWillUnmount() {\r\n        this.Unmount = true;\r\n    }\r\n    async  componentDidMount() {\r\n        const { dataSource } = this.props;\r\n        let mockData = [],\r\n            res = [];\r\n        try {\r\n            // 值为 数组 \r\n            if (lodash.isArray(dataSource)) {\r\n                res = dataSource;\r\n            }\r\n            // 值为 Promise\r\n            else if (dataSource instanceof Promise) {\r\n                res = await dataSource;\r\n            }\r\n            // 值为 Observable \r\n            else if (dataSource instanceof Observable) {\r\n                res = await dataSource.toPromise();\r\n            }\r\n            // 转换 数据 为 渲染 格式\r\n            mockData = this.recursionTree(res, null);\r\n        } catch (error) {\r\n            console.error(\"获取数据出错\", error)\r\n        }\r\n        if (this.Unmount) return;\r\n        this.setState({\r\n            mockData,\r\n            originalData: res,\r\n            loading: false\r\n        })\r\n        // this.formatDataSource(mockData)\r\n    }\r\n    /**\r\n     * 递归 格式化 树\r\n     * @param datalist \r\n     * @param ParentId \r\n     * @param children \r\n     */\r\n    recursionTree(datalist, ParentId, children = []) {\r\n        lodash.filter(datalist, [this.ParentIdKey, ParentId]).map(data => {\r\n            data = {\r\n                ...data,\r\n                value: lodash.toString(lodash.get(data, this.key)),\r\n                label: lodash.get(data, this.title),\r\n            }\r\n            children.push(data);\r\n            data.children = this.recursionTree(datalist, data.Value, data.children || [])\r\n        });\r\n        return children;\r\n    }\r\n    /**\r\n     * 格式化 插入 数据\r\n     * @param mockData \r\n     */\r\n    formatDataSource(mockData: any[]) {\r\n        try {\r\n            this.setState({\r\n                mockData: mockData.map(this.mapData.bind(this)),\r\n                loading: false\r\n            })\r\n        } catch (error) {\r\n            console.error(\"获取数据出错\", error)\r\n        }\r\n    }\r\n    mapData(item) {\r\n        let children: any[] = lodash.get(item, this.children);\r\n        const childrenUrl = lodash.get(item, this.childrenUrl);\r\n        const newItem = {\r\n            ...item,\r\n            value: lodash.toString(lodash.get(item, this.key)),\r\n            label: lodash.get(item, this.title),\r\n            childrenUrl,\r\n            // isLeaf: false,\r\n            // children: children && children.map(mapData)\r\n        }\r\n        // 远程 路径 \r\n        if (childrenUrl) {\r\n            lodash.set(newItem, 'isLeaf', false);\r\n        }\r\n        if (children && children.length > 0) {\r\n            lodash.set(newItem, 'children', children.map(this.mapData.bind(this)));\r\n        }\r\n        return newItem\r\n    }\r\n    // filterOption = (inputValue, option) => option.description.indexOf(inputValue) > -1\r\n    handleChange = (targetKeys) => {\r\n        // 多选 返回 值 为数组 的情况下 有 dataKey 重组 数据\r\n        if (this.props.dataKey && lodash.isArray(targetKeys)) {\r\n            targetKeys = targetKeys.map(x => (\r\n                { [this.props.dataKey]: x }\r\n            ))\r\n        }\r\n        if (lodash.get(this.props, 'lastData', true)) {\r\n            targetKeys = lodash.last(targetKeys);\r\n        }\r\n        this.props.onChange && this.props.onChange(targetKeys);\r\n    }\r\n    loadData = async (selectedOptions) => {\r\n        const targetOption = lodash.head(selectedOptions) as any;\r\n        const childrenUrl = lodash.get(targetOption, this.childrenUrl)\r\n        if (childrenUrl) {\r\n            targetOption.loading = true;\r\n            const time = Date.now();\r\n            const children: any[] = await Request.cache({ url: childrenUrl });\r\n            // 强制 执行加载最少 400 毫秒\r\n            await new Promise((res, rej) => {\r\n                lodash.delay(res, 400 - (Date.now() - time))\r\n            });\r\n            targetOption.loading = false;\r\n            lodash.set(targetOption, 'children', children.map(this.mapData.bind(this)));\r\n            if (this.Unmount) return;\r\n            this.setState({\r\n                mockData: [...this.state.mockData],\r\n            });\r\n        }\r\n        // load options lazily\r\n        // setTimeout(() => {\r\n        //     targetOption.loading = false;\r\n        //     targetOption.children = [{\r\n        //         label: `${targetOption.label} Dynamic 1`,\r\n        //         value: 'dynamic1',\r\n        //     }, {\r\n        //         label: `${targetOption.label} Dynamic 2`,\r\n        //         value: 'dynamic2',\r\n        //     }];\r\n        //     this.setState({\r\n        //         mockData: [...this.state.mockData],\r\n        //     });\r\n        // }, 1000);\r\n    }\r\n    // 查找父级\r\n    getParent(value, ids = []) {\r\n        const key = lodash.get(lodash.find(this.state.originalData, [this.key, value]), this.ParentIdKey);\r\n        if (key) {\r\n            this.getParent(key, ids)\r\n            ids.push(key);\r\n        }\r\n        return ids;\r\n    }\r\n    // 获取默认值\r\n    getDefaultValue(value) {\r\n        if (value && !this.state.loading) {\r\n            const defaultValue = this.getParent(value);\r\n            defaultValue.push(value);\r\n            if (defaultValue.length > 0) {\r\n                return {\r\n                    value: defaultValue\r\n                }\r\n            }\r\n        }\r\n        return {\r\n        }\r\n    }\r\n    renderDisplay(config: CascaderProps) {\r\n        let str = ''\r\n        if (!this.state.loading && lodash.isArray(config.value)) {\r\n            str = config.value.map(value => {\r\n                return lodash.get(lodash.find(this.state.originalData, [this.key, value]), this.title)\r\n            }).join(\" / \")\r\n        }\r\n        return <span>{str}</span>\r\n    }\r\n    render() {\r\n        let config: CascaderProps = {\r\n            placeholder: this.props.placeholder,\r\n            options: this.state.mockData,\r\n            allowClear: true,\r\n            loadData: this.loadData,\r\n            changeOnSelect: true,\r\n            disabled: this.props.disabled,\r\n            onChange: this.handleChange,\r\n            ...this.getDefaultValue(this.props.value)\r\n            // defaultValue: this.props.value\r\n        }\r\n        return (\r\n            <Spin spinning={this.state.loading}>\r\n                {this.props.display ? this.renderDisplay(config) : <Cascader {...config}></Cascader>}\r\n            </Spin>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default WtmCascader","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:42\r\n * @modify date 2019-02-24 17:06:42\r\n * @desc [description]\r\n */\r\nimport { Checkbox, Col, Row } from 'antd';\r\nimport { CheckboxGroupProps } from 'antd/lib/checkbox';\r\nimport { DesLoadingData, ILoadingDataProps } from 'components/decorators'; //错误\r\nimport React from 'react';\r\n@DesLoadingData()\r\nexport class WtmCheckbox extends React.Component<ILoadingDataProps & CheckboxGroupProps, any> {\r\n    static wtmType = \"Checkbox\";\r\n    state = {\r\n        spinning: false,\r\n        dataSource: [],\r\n    }\r\n    render() {\r\n        const { dataSource, ...props } = this.props;\r\n        return (\r\n            <Checkbox.Group style={{ width: '100%' }} {...props}>\r\n                {this.renderItem(this.state.dataSource)}\r\n            </Checkbox.Group>\r\n        );\r\n    }\r\n    renderItem(dataSource) {\r\n        if (this.props.renderItem) {\r\n            return this.props.renderItem(dataSource)\r\n        }\r\n        return <Row type=\"flex\" align=\"middle\">\r\n            {dataSource.map(data => {\r\n                return <Col key={data.value}>\r\n                    <Checkbox value={data.value}>{data.title}</Checkbox>\r\n                </Col>\r\n            })}\r\n        </Row>\r\n    }\r\n}\r\nexport default WtmCheckbox","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-26 00:21:18\r\n * @modify date 2019-02-26 00:21:18\r\n * @desc [description]\r\n */\r\nimport { DatePicker } from 'antd';\r\nimport { DatePickerProps } from 'antd/lib/date-picker/interface';\r\nimport lodash from 'lodash';\r\nimport moment from 'moment';\r\nimport * as React from 'react';\r\nconst { MonthPicker, RangePicker, WeekPicker } = DatePicker;\r\n\r\n\r\ninterface IWtmDatePickerProps extends DatePickerProps {\r\n  display?: boolean;\r\n  [key: string]: any;\r\n}\r\nexport class WtmDatePicker extends React.Component<IWtmDatePickerProps, any> {\r\n  static wtmType = \"DatePicker\";\r\n  onChange(data, dataString) {\r\n    const onChange: any = this.props.onChange;\r\n    // onChange && onChange(moment(dataString, this.getFormat()).valueOf(), data)\r\n    onChange && onChange(dataString, data)\r\n  }\r\n  getFormat() {\r\n    const { showTime, format } = this.props;\r\n    if (format) {\r\n      return format\r\n    }\r\n    return showTime ? \"YYYY-MM-DD HH:mm:ss\" : \"YYYY-MM-DD\";\r\n  }\r\n  render() {\r\n    let props: any = {\r\n      format: this.getFormat(),\r\n      ...this.props\r\n    }\r\n    if (this.props.display) {\r\n      return <span>{moment(props.value, props.format).format(props.format)}</span>\r\n    }\r\n    if (props.value) {\r\n      // 转换 默认值\r\n      if (lodash.isString(props.value)) {\r\n        props.defaultValue = moment(props.value, props.format)\r\n      }\r\n    }\r\n    // console.log(\"TCL: WtmRangePicker -> render -> props\", this.props)\r\n    delete props.value;\r\n    return (<DatePicker  {...props} onChange={this.onChange.bind(this)} />);\r\n  }\r\n}\r\n\r\ninterface IWtmRangePickerProps extends DatePickerProps {\r\n  display?: boolean;\r\n  [key: string]: any;\r\n}\r\nexport class WtmRangePicker extends React.Component<IWtmRangePickerProps, any> {\r\n  static wtmType = \"RangePicker\";\r\n  onChange(data, dataString) {\r\n    const onChange: any = this.props.onChange;\r\n    onChange && onChange(dataString, data)\r\n  }\r\n  getFormat() {\r\n    const { showTime, format } = this.props;\r\n    if (format) {\r\n      return format\r\n    }\r\n    return showTime ? \"YYYY-MM-DD HH:mm:ss\" : \"YYYY-MM-DD\";\r\n  }\r\n  render() {\r\n    let props: any = {\r\n      format: this.getFormat(),\r\n      ...this.props\r\n    }\r\n    if (this.props.display) {\r\n      return <span>{moment(props.value, props.format).format(props.format)}</span>\r\n    }\r\n    if (props.value) {\r\n      // 转换 默认值\r\n      if (lodash.isString(props.value)) {\r\n        props.defaultValue = moment(props.value, props.format)\r\n      }\r\n    }\r\n    delete props.value;\r\n    return (<RangePicker  {...props} onChange={this.onChange.bind(this)} />);\r\n  }\r\n}\r\nexport default WtmDatePicker\r\n","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2018-09-12 18:53:42\r\n * @modify date 2018-09-12 18:53:42\r\n * @desc [description]\r\n*/\r\nimport { Card } from 'antd';\r\nimport BraftEditor, { BraftEditorProps, EditorState } from 'braft-editor';\r\nimport 'braft-editor/dist/index.css';\r\nimport lodash from 'lodash';\r\nimport React from 'react';\r\nimport './style.less';\r\nimport globalConfig from 'global.config';\r\nimport RequestFiles from 'utils/RequestFiles';\r\n\r\n\r\n\r\ninterface IAppProps extends BraftEditorProps {\r\n  display?: boolean;\r\n  disabled?: boolean;\r\n  onChange?: any;\r\n  [key: string]: any;\r\n}\r\n/**\r\n * https://github.com/margox/braft-editor\r\n * 富文本编辑\r\n */\r\nexport class WtmEditor extends React.Component<IAppProps, any> {\r\n  static wtmType = \"Editor\";\r\n  console = globalConfig.development\r\n  default: BraftEditorProps = {\r\n    media: {\r\n      uploadFn: (params) => {\r\n        console.log(\"TCL: WtmEditor -> params\", params)\r\n        RequestFiles.customRequest({\r\n          action: RequestFiles.FileTarget,\r\n          filename: \"file\",\r\n          file: params.file,\r\n          onProgress: (event) => {\r\n            params.progress(event.percent)\r\n          },\r\n          onSuccess: (res) => {\r\n            const url = RequestFiles.onFileDownload(res.Id);\r\n            params.success({\r\n              url: url,\r\n              meta: {\r\n                id: res.Id,\r\n                title: res.Name,\r\n                alt: res.Name,\r\n                loop: true, // 指定音视频是否循环播放\r\n                autoPlay: true, // 指定音视频是否自动播放\r\n                controls: true, // 指定音视频是否显示控制栏\r\n                poster: url, // 指定视频播放器的封面\r\n              }\r\n            })\r\n          },\r\n          onError: (err) => {\r\n            params.error({\r\n              msg: err.message\r\n            })\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n  componentDidMount() {\r\n  }\r\n  state = {\r\n    editorState: BraftEditor.createEditorState(lodash.unescape(this.props.value)), // 设置编辑器初始内容\r\n  }\r\n  onChange(editorState: EditorState) {\r\n    if (lodash.isEqual(this.state.editorState.toRAW(), editorState.toRAW())) {\r\n      return this.setState({ editorState });\r\n    }\r\n    this.setState({ editorState });\r\n    const value = editorState.toHTML()\r\n    this.console && console.log(value)\r\n    this.props.onChange && this.props.onChange(lodash.escape(lodash.eq(value, '<p></p>') ? '' : value), editorState)\r\n  }\r\n  render() {\r\n    const { editorState } = this.state;\r\n    const props = { ...this.default, ...this.props }\r\n    delete props.value;\r\n    delete props.onChange;\r\n    // 禁用\r\n    if (this.props.display) {\r\n      props.controls = [];\r\n      props.disabled = true;\r\n    }\r\n    return <Card className=\"app-editor-card\">\r\n      <BraftEditor\r\n        value={editorState}\r\n        onChange={this.onChange.bind(this)}\r\n        {...props}\r\n      />\r\n    </Card>\r\n  }\r\n}\r\nexport default WtmEditor\r\n\r\n","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:42\r\n * @modify date 2019-02-24 17:06:42\r\n * @desc [description]\r\n */\r\nimport { Select, notification, Spin, Table, Button, ConfigProvider, Divider, Form, Popconfirm, Alert } from 'antd';\r\nimport { SelectProps } from 'antd/lib/select';\r\nimport { DesError, DesForm } from 'components/decorators'; //错误\r\nimport lodash from 'lodash';\r\nimport { Debounce } from 'lodash-decorators';\r\nimport React from 'react';\r\nimport { Observable } from 'rxjs';\r\nimport { WrappedFormUtils } from 'antd/lib/form/Form';\r\nimport { DialogForm, DialogFormDes, FormItem, InfoShellLayout } from 'components/dataView';\r\nimport { ColumnProps } from 'antd/lib/table';\r\nimport { Help } from 'utils/Help';\r\nimport { observable, action, runInAction, toJS } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport './style.less';\r\nlet EditableContext = React.createContext(null);\r\n@DesForm\r\nclass EditableRow extends React.Component<any, any> {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    FieldsValue = {};\r\n    rowKey = lodash.get(this.props, 'data-row-key');\r\n    onEdit(isEdit = true) {\r\n        const {\r\n            handleUpdate,\r\n            ...restProps\r\n        } = this.props;\r\n        this.props.form.validateFields((err, values) => {\r\n            if (!lodash.isEqual(this.FieldsValue, values)) {\r\n                this.FieldsValue = values;\r\n                handleUpdate(this.rowKey, this.FieldsValue);\r\n            }\r\n        })\r\n    }\r\n    componentDidMount() {\r\n        const {\r\n            form,\r\n            models,\r\n            handleUpdate,\r\n            ...restProps\r\n        } = this.props;\r\n        const FieldsValue = form.getFieldsValue();\r\n        if (!lodash.isEqual(this.FieldsValue, FieldsValue)) {\r\n            this.FieldsValue = FieldsValue;\r\n        }\r\n        this.props.form.validateFields()\r\n        // console.log(\"componentDidMount\")\r\n    }\r\n    render() {\r\n        const {\r\n            form,\r\n            models,\r\n            handleUpdate,\r\n            ...restProps\r\n        } = this.props;\r\n        return (\r\n            <EditableContext.Provider value={{\r\n                form: form,\r\n                models: models,\r\n            }}>\r\n                <tr {...restProps}\r\n                    onMouseEnter={this.onEdit.bind(this, true)} onMouseLeave={this.onEdit.bind(this, false)} />\r\n            </EditableContext.Provider>\r\n        );\r\n    }\r\n}\r\nclass EditableCell extends React.Component<any, any>{\r\n    constructor(props) {\r\n        super(props)\r\n    }\r\n    renderForm(props) {\r\n        return <FormItem\r\n            fieId={this.props.dataIndex}\r\n            layout=\"row-hidden-label\"\r\n            {...props}\r\n            {...lodash.get(props, `models.${this.props.dataIndex}.formItemProps`)}\r\n            defaultValues={toJS(this.props.record)}\r\n        />\r\n    }\r\n    render() {\r\n        const {\r\n            dataIndex,\r\n            title,\r\n            record,\r\n            index,\r\n            width,\r\n            ...restProps\r\n        } = this.props;\r\n        let style: any = {};\r\n        if (width) {\r\n            style.width = width - 36;\r\n        }\r\n        return (\r\n            <td {...restProps}>\r\n                {record ? <EditableContext.Consumer>\r\n                    {this.renderForm.bind(this)}\r\n                </EditableContext.Consumer> : restProps.children}\r\n            </td>\r\n        );\r\n    }\r\n}\r\n\r\n@observer\r\n@DesError\r\nexport class EditTable extends React.Component<IAppProps, any> {\r\n    @observable dataSource = [];\r\n    @observable columns = [];\r\n    @action\r\n    onUpdateDataSource(dataSource) {\r\n        this.dataSource = dataSource;\r\n        this.handleChange();\r\n    }\r\n    Unmount = false\r\n    componentWillUnmount() {\r\n        this.Unmount = true;\r\n    }\r\n    componentDidUpdate() {\r\n    }\r\n    componentDidMount() {\r\n        const columns = this.createColumns();\r\n        if (this.props.deleteButton && !(this.props.disabled || this.props.display)) {\r\n            columns.push({\r\n                title: \"操作\",\r\n                width: 70,\r\n                // fixed: \"right\",\r\n                render: (text, record, index) => <div><a onClick={this.handleRemove.bind(this, record)}>删除</a></div>\r\n            });\r\n        }\r\n        // this.setState({ columns })\r\n        runInAction(() => {\r\n            this.columns = columns;\r\n            if (lodash.isArray(this.props.value) && this.props.value.length > 0) {\r\n                this.dataSource = this.props.value.map(x => {\r\n                    // console.log(x, this.props.rowKey, lodash.get(x, this.props.rowKey))\r\n                    return {\r\n                        ...this.props.setValues,\r\n                        ...x,\r\n                        __key: lodash.get(x, this.props.rowKey)\r\n                    }\r\n                })\r\n            }\r\n        });\r\n    }\r\n    @Debounce(100)\r\n    handleChange() {\r\n        this.props.onChange(toJS(this.dataSource));\r\n    }\r\n    @Debounce(100)\r\n    handleAdd() {\r\n        const dataSource = [...this.dataSource];\r\n        dataSource.push({\r\n            ...this.props.setValues,\r\n            __key: Help.GUID(),\r\n            ...lodash.mapValues(this.props.models, (value) => {\r\n                return undefined\r\n            })\r\n        });\r\n        this.onUpdateDataSource(dataSource)\r\n    }\r\n    handleSave() {\r\n        this.onUpdateDataSource(toJS(this.dataSource))\r\n    }\r\n    handleRemove(record) {\r\n        const dataSource = [...this.dataSource];\r\n        lodash.remove(dataSource, ['__key', record.__key]);\r\n        this.onUpdateDataSource(dataSource);\r\n    }\r\n    handleUpdate = (rowKey, data) => {\r\n        const dataSource = [...this.dataSource];\r\n        const index = lodash.findIndex(dataSource, ['__key', rowKey]);\r\n        lodash.update(dataSource, `[${index}]`, value => {\r\n            return {\r\n                ...value,\r\n                ...data,\r\n            }\r\n        });\r\n        this.onUpdateDataSource(dataSource);\r\n    }\r\n    createColumns(): ColumnProps<any>[] {\r\n        return lodash.map(this.props.models, (value, key) => {\r\n            return {\r\n                key,\r\n                dataIndex: key,\r\n                title: value.label,\r\n                width: 150,\r\n                ...value.columnsProps,\r\n                onCell: (record, rowIndex) => ({\r\n                    record,\r\n                    dataIndex: key,\r\n                    title: value.label,\r\n                    width: 150,\r\n                    ...value.columnsProps,\r\n                })\r\n            }\r\n        })\r\n    }\r\n    render() {\r\n        const columns = [...this.columns];\r\n        const dataSource = [...this.dataSource];\r\n        const models = lodash.mapValues(this.props.models, value => {\r\n            return {\r\n                ...value,\r\n                formItemProps: {\r\n                    ...value.formItemProps,\r\n                    disabled: !!this.props.disabled,\r\n                    display: !!this.props.display,\r\n                }\r\n            }\r\n        });\r\n        return (\r\n            <ConfigProvider renderEmpty={() => <div>暂无数据</div>}>\r\n                {this.props.addButton && !(this.props.disabled || this.props.display) && <Button onClick={this.handleAdd.bind(this)}>新建</Button>}\r\n                {/* <Divider type=\"vertical\" />\r\n                <Alert message=\"验证未通过行提交数据将忽略\" type=\"warning\" showIcon closable style={{ display: \"inline-block\" }} /> */}\r\n                <Table\r\n                    rowKey=\"__key\"\r\n                    bordered\r\n                    components={{\r\n                        body: {\r\n                            row: (props) => <EditableRow {...props} models={models} handleUpdate={this.handleUpdate} />,\r\n                            cell: EditableCell\r\n                        }\r\n                    }}\r\n                    className=\"WtmEditTable\"\r\n                    style={{\r\n                        display: dataSource.length <= 0 ? \"none\" : \"\"\r\n                    }}\r\n                    columns={columns}\r\n                    dataSource={dataSource}\r\n                    pagination={false}\r\n                    scroll={{\r\n                        x: columns.reduce((accumulator, currentValue) => {\r\n                            return Math.ceil(accumulator + (currentValue.width || 0))\r\n                        }, 0)\r\n                    }}\r\n                />\r\n\r\n            </ConfigProvider>\r\n        );\r\n    }\r\n}\r\n\r\ninterface IAppProps {\r\n    /** 模型 */\r\n    models: WTM.FormItem;\r\n    /** 行 Key 值 默认 ID */\r\n    rowKey?: string;\r\n    setValues?: any;\r\n    onChange?: (value) => void;\r\n    value?: any;\r\n    addButton?: boolean;\r\n    deleteButton?: boolean;\r\n    display?: boolean;\r\n    disabled?: boolean;\r\n}\r\n@DesError\r\nexport class WtmEditTable extends React.Component<IAppProps, any> {\r\n    static wtmType = \"EditTable\";\r\n    Unmount = false\r\n    componentWillUnmount() {\r\n        this.Unmount = true;\r\n    }\r\n    componentDidUpdate() {\r\n    }\r\n    componentDidMount() {\r\n        console.log(this.props)\r\n    }\r\n    handleChange = (dataSource) => {\r\n        this.props.onChange(dataSource);\r\n    }\r\n    render() {\r\n        return <EditTable\r\n            rowKey={lodash.get(this.props, \"rowKey\", \"ID\")}\r\n            value={this.props.value}\r\n            models={this.props.models}\r\n            onChange={this.handleChange}\r\n            setValues={this.props.setValues}\r\n            disabled={lodash.get(this.props, \"disabled\", false)}\r\n            display={lodash.get(this.props, \"display\", false)}\r\n            addButton={lodash.get(this.props, \"addButton\", true)}\r\n            deleteButton={lodash.get(this.props, \"deleteButton\", true)}\r\n        />\r\n    }\r\n}\r\nexport default WtmEditTable","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:42\r\n * @modify date 2019-02-24 17:06:42\r\n * @desc [description]\r\n */\r\nimport { Radio, Spin, Tag, Row, Col } from 'antd';\r\nimport { DesError, DesLoadingData, ILoadingDataProps } from 'components/decorators'; //错误\r\nimport lodash from 'lodash';\r\nimport React from 'react';\r\nimport { Observable } from 'rxjs';\r\nimport { RadioGroupProps } from 'antd/lib/radio';\r\n@DesLoadingData()\r\nexport class WtmRadio extends React.Component<ILoadingDataProps & RadioGroupProps, any> {\r\n    static wtmType = \"Radio\";\r\n    state = {\r\n        spinning: false,\r\n        dataSource: [],\r\n    }\r\n    render() {\r\n        const { dataSource, ...props } = this.props;\r\n        return (\r\n            <Radio.Group {...props} >\r\n                {this.renderItem(this.state.dataSource)}\r\n            </Radio.Group>\r\n        );\r\n    }\r\n    renderItem(dataSource) {\r\n        if (this.props.renderItem) {\r\n            return this.props.renderItem(dataSource)\r\n        }\r\n        return <Row type=\"flex\" align=\"middle\">\r\n            {dataSource.map(data => {\r\n                return <Col key={data.value}>\r\n                    <Radio value={data.value}>{data.title}</Radio>\r\n                </Col>\r\n            })}\r\n        </Row>\r\n    }\r\n}\r\nexport default WtmRadio","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:42\r\n * @modify date 2019-02-24 17:06:42\r\n * @desc [description]\r\n */\r\nimport { Select } from 'antd';\r\nimport { SelectProps } from 'antd/lib/select';\r\nimport { DesLoadingData, ILoadingDataProps } from 'components/decorators'; //错误\r\nimport { mergeLocales, getLocalesValue, getLocalesTemplate } from 'locale';\r\nimport React from 'react';\r\n@DesLoadingData()\r\nexport class WtmSelect extends React.Component<ILoadingDataProps & SelectProps<any>, any> {\r\n    static wtmType = \"Select\";\r\n    state = {\r\n        spinning: false,\r\n        dataSource: [],\r\n    }\r\n    render() {\r\n        const { dataSource, ...props } = this.props;\r\n        if (props.value === null) {\r\n            delete props.value\r\n        }\r\n        return (\r\n            <Select\r\n                placeholder={getLocalesTemplate('tips.placeholder.choose',{txt:''})}\r\n                allowClear\r\n                showSearch\r\n                filterOption={(input, option: any) => {\r\n                    return option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                }}\r\n                {...props}\r\n            >\r\n                {this.renderItem(this.state.dataSource)}\r\n            </Select>\r\n        );\r\n    }\r\n    renderItem(dataSource) {\r\n        if (this.props.renderItem) {\r\n            return this.props.renderItem(dataSource)\r\n        }\r\n        return dataSource.map(x => {\r\n            return <Select.Option key={x.key} value={x.key}>{x.title}</Select.Option>\r\n        })\r\n    }\r\n}\r\nexport default WtmSelect\r\n","/**\r\n * @author 冷 (https://github.com/LengYXin)\r\n * @email lengyingxin8966@gmail.com\r\n * @create date 2019-02-24 17:06:47\r\n * @modify date 2019-02-24 17:06:47\r\n * @desc [description]\r\n */\r\nimport { Transfer } from 'antd';\r\nimport { TransferProps } from 'antd/lib/transfer';\r\nimport { DesLoadingData, ILoadingDataProps } from 'components/decorators'; //错误\r\nimport React from 'react';\r\n@DesLoadingData()\r\nexport class WtmTransfer extends React.Component<ILoadingDataProps & TransferProps & { value?: any }, any> {\r\n    static wtmType = \"Transfer\";\r\n    state = {\r\n        spinning: false,\r\n        dataSource: [],\r\n    }\r\n    render() {\r\n        const { dataSource, ...props } = this.props;\r\n        return (\r\n            <Transfer\r\n                render={item => item.title}\r\n                dataSource={this.state.dataSource}\r\n                targetKeys={props.value}\r\n                // showSearch\r\n                // filterOption={(inputValue, option) => option.description.indexOf(inputValue) > -1}\r\n                {...props}\r\n            />\r\n        );\r\n    }\r\n}\r\nexport default WtmTransfer","import { Icon, message, Modal, Upload, Button } from \"antd\";\r\nimport React from \"react\";\r\nimport RequestFiles from 'utils/RequestFiles';\r\nimport lodash from 'lodash'\r\nexport class WtmUpload extends React.Component<any, any> {\r\n    static wtmType = \"Upload\";\r\n    img = new Image();\r\n    state = {\r\n        loading: false,\r\n        previewVisible: false,\r\n        previewImage: '',\r\n        fileList: this.props.value != null && this.props.value != \"\" ? [\r\n            {\r\n                uid: '-1',\r\n                name: 'xxx.png',\r\n                status: 'done',\r\n                url: RequestFiles.onFileUrl(this.props.value),\r\n            }\r\n        ] : [],\r\n    };\r\n    createViewer(fileId) {\r\n        if (fileId) {\r\n            this.img.src = RequestFiles.onFileUrl(fileId);\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.createViewer(this.props.value)\r\n    }\r\n    componentWillUnmount() {\r\n    }\r\n    onChange(data) {\r\n        this.props.onChange(data);\r\n    }\r\n    handleChange = (info) => {\r\n        if (info.file.status === 'uploading') {\r\n            this.setState({ fileList: info.fileList, loading: true });\r\n            //  this.setState({ loading: true });\r\n        }\r\n        if (info.file.status === 'done') {\r\n            const response = info.file.response\r\n            if (typeof response.Id === \"string\") {\r\n                this.createViewer(response.Id);\r\n                this.onChange(response.Id);\r\n            } else {\r\n                message.error(`${info.file.name} ${response.message}`)\r\n            }\r\n            this.setState({ fileList: info.fileList, loading: false });\r\n        }\r\n    }\r\n    onRemove = (file) => {\r\n        if (this.props.disabled) {\r\n            return\r\n        }\r\n        const response = file.response\r\n        this.setState({ fileList: [], loading: false }, () => {\r\n            this.onChange(null);\r\n        });\r\n        const fileId = response && response.Id //|| this.props.value\r\n        if (typeof fileId === \"string\") {\r\n            setTimeout(() => {\r\n                RequestFiles.onFileDelete(fileId)\r\n            });\r\n        }\r\n    }\r\n    render() {\r\n        return (\r\n            <Upload\r\n                action={RequestFiles.FileTarget}\r\n                onChange={this.handleChange}\r\n                onRemove={this.onRemove}\r\n            >\r\n                <Button>\r\n                    <Icon type=\"upload\" /> 选择文件\r\n    </Button>\r\n            </Upload>\r\n        );\r\n    }\r\n}\r\nexport default WtmUpload","import { Icon, message, Modal, Upload } from \"antd\";\r\nimport React from \"react\";\r\nimport RequestFiles from 'utils/RequestFiles';\r\nimport Viewer from 'viewerjs';\r\nimport lodash from 'lodash'\r\nfunction beforeUpload(file) {\r\n    console.log(file.type)\r\n    const isJPG = lodash.includes(file.type, 'image/');\r\n    if (!isJPG) {\r\n        message.error('You can only upload image file!');\r\n    }\r\n    // const isLt2M = file.size / 1024 / 1024 < 2;\r\n    // if (!isLt2M) {\r\n    //     message.error('Image must smaller than 2MB!');\r\n    // }\r\n    return isJPG //&& isLt2M;\r\n}\r\nexport class WtmUploadImg extends React.Component<any, any> {\r\n    static wtmType = \"UploadImg\";\r\n    img = new Image();\r\n    viewer: Viewer = new Viewer(this.img);\r\n    state = {\r\n        loading: false,\r\n        previewVisible: false,\r\n        previewImage: '',\r\n        fileList: this.props.value != null && this.props.value != \"\" ? [\r\n            {\r\n                uid: '-1',\r\n                name: 'xxx.png',\r\n                status: 'done',\r\n                url: RequestFiles.onFileUrl(this.props.value),\r\n                // response:{Id:this.props.value}\r\n            }\r\n        ] : [],\r\n    };\r\n    createViewer(fileId) {\r\n        if (fileId) {\r\n            this.img.src = RequestFiles.onFileUrl(fileId);\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.createViewer(this.props.value)\r\n    }\r\n    componentWillUnmount() {\r\n        this.viewer && this.viewer.destroy();\r\n    }\r\n    onChange(data) {\r\n        this.props.onChange(data);\r\n    }\r\n    handleChange = (info) => {\r\n        if (info.file.status === 'uploading') {\r\n            this.setState({ fileList: info.fileList, loading: true });\r\n            //  this.setState({ loading: true });\r\n        }\r\n        if (info.file.status === 'done') {\r\n            const response = info.file.response\r\n            if (typeof response.Id === \"string\") {\r\n                this.createViewer(response.Id);\r\n                this.onChange(response.Id);\r\n            } else {\r\n                message.error(`${info.file.name} ${response.message}`)\r\n            }\r\n            this.setState({ fileList: info.fileList, loading: false });\r\n        }\r\n    }\r\n    handlePreview = (file) => {\r\n        this.viewer.show()\r\n        // this.setState({\r\n        //     previewImage: file.url || file.thumbUrl,\r\n        //     previewVisible: true,\r\n        // });\r\n    }\r\n    onRemove = (file) => {\r\n        if (this.props.disabled) {\r\n            return\r\n        }\r\n        const response = file.response\r\n        this.setState({ fileList: [], loading: false }, () => {\r\n            this.onChange(undefined);\r\n        });\r\n        const fileId = response && response.Id //|| this.props.value\r\n        if (typeof fileId === \"string\") {\r\n            RequestFiles.onFileDelete(fileId)\r\n        }\r\n    }\r\n    render() {\r\n        const { previewVisible, previewImage, fileList, loading } = this.state;\r\n        const uploadButton = (\r\n            <div>\r\n                <Icon type={loading ? 'loading' : 'plus'} />\r\n                <div className=\"ant-upload-text\">Upload</div>\r\n            </div>\r\n        );\r\n        return (\r\n            <div style={{ minWidth: 105, minHeight: 105 }}>\r\n                <Upload\r\n                    accept='image/*'\r\n                    listType=\"picture-card\"\r\n                    fileList={fileList as any}\r\n                    action={RequestFiles.FileTarget}\r\n                    beforeUpload={beforeUpload}\r\n                    onChange={this.handleChange}\r\n                    onPreview={this.handlePreview}\r\n                    onRemove={this.onRemove}\r\n                >\r\n                    {fileList.length == 0 && uploadButton}\r\n                </Upload>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default WtmUploadImg","export * from \"./cascader\";\r\nexport * from \"./checkbox\";\r\nexport * from \"./datePicker\";\r\nexport * from \"./editer\";\r\nexport * from \"./editTable\";\r\nexport * from \"./radio\";\r\nexport * from \"./select\";\r\nexport * from \"./transfer\";\r\nexport * from \"./upload\";\r\nexport * from \"./uploadImg\";\r\n\r\n\r\n"],"sourceRoot":""}